</html>
  <head>
    <title>GEOG 483</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width">
      <meta name="description" content="Affordable Web Design For Small And Medium-sized Companies">
      <meta name="author" content="Sebastian Eschweiler">
      <title>Open Data Portal</title>
      <!-- Import libraries -->      
      <script src="https://code.jquery.com/jquery-3.0.0.js" integrity="sha256-jrPLZ+8vDxt2FnE1zvZXCkCcebI/C8Dt5xyaQBjxQIo=" crossorigin="anonymous"></script>
      <link rel="stylesheet" href="/static/style.css">
      <!-- link rel="stylesheet" href="../static/styles/css/font-awesome.min.css"> -->
      <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
          integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
          crossorigin=""/>
      <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
          integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
          crossorigin=""></script>
      <!-- esri-leaflet library -->
      <script src="https://unpkg.com/esri-leaflet@2.1.2"></script>

    </head>
    <body>
      <header>
        <div class="container">
          <div id="branding">
            <h1><i class="fa fa-rocket"></i> <span class="highlight">Open Data</span> Portal</h1>
          </div>
          <nav>
            <ul>
              <li><a href="index.html">Home</a></li>
              <li><a href="about.html">About</a></li>
              <li class="current"><a href="services.html">Services</a></li>
            </ul>
          </nav>
        </div>
          
      </header>
      <section id="chatWindow" class="main">
        <div class="container">
          <article id="main-col">
            <h1 class="page-title">Chat Bot Service</h1>
                <div id="question"><h1>What can I help you with?</h1></div>
                <div id="search_box"><input type="text" id="search_form_input"></input></div>
                <div style="position: relative, left:80px; top:2px;" class="chatbot">
              </div>
          </article>
          <aside id="sidebar">
          </aside>
        </div>
      </section>
       <footer>
        <p>Open Data Portal, Copyright &copy; 2018</p>
      </footer>

   <script type="text/javascript">

      function manageActions() {
        var watsonResponse = document.getElementById('chatWindow').lastChild.lastChild
        var action = watsonResponse.querySelector('#action').className
        if (action == 'download') { 
          var downloadUrl = watsonResponse.querySelector('#action').innerHTML
          window.location.href = downloadUrl
        }  
      }

      $("#search_form_input").keypress(function(e){
        if(e.which == 13){
          var text = $(this).val();
          var d1=document.getElementById('chatWindow')

          d1.insertAdjacentHTML('beforeend', "<div class='user'>" + $(this).val() + "</div>");
          d1.insertAdjacentHTML('beforeend', "<div id='loading' class='watson'><div class='loader'></div></div>");
          $("#chatWindow").animate({"scrollTop": $('#chatWindow')[0].scrollHeight}, "fast")

          e.currentTarget.value = ""
          $.ajax({
          url: "/askWatson",
          type: "get",
          data: {jsdata: text},
          success: function(response) {
            document.getElementById('loading').remove();
            $("#chatWindow").append("<div class='watson'>" + response + "</div>");
            $("#chatWindow").animate({"scrollTop": $('#chatWindow')[0].scrollHeight}, "fast")
			//$("#chatWindow").animate({scrollTop: $("#chatWindow").height()})
            manageActions()
            
          },
          error: function(xhr) {
          //Do Something to handle error
          }
        });
      }
    });

    </script>
  </body>



    </body>
</html>